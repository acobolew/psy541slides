<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Class 2</title>
  <meta name="description" content="Class 2">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Class 2" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Class 2" />
  
  
  

<meta name="author" content="Tobias Gerstenberg">


<meta name="date" content="2018-12-21">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  


<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path=""><a href="#visualization-1"><i class="fa fa-check"></i><b>1</b> Visualization 1</a><ul>
<li class="chapter" data-level="1.1" data-path=""><a href="#learning-objectives"><i class="fa fa-check"></i><b>1.1</b> Learning objectives</a></li>
<li class="chapter" data-level="1.2" data-path=""><a href="#load-packages"><i class="fa fa-check"></i><b>1.2</b> Load packages</a></li>
<li class="chapter" data-level="1.3" data-path=""><a href="#why-visualize-data"><i class="fa fa-check"></i><b>1.3</b> Why visualize data?</a><ul>
<li class="chapter" data-level="1.3.1" data-path=""><a href="#how-not-to-visualize-data"><i class="fa fa-check"></i><b>1.3.1</b> How <em>not</em> to visualize data</a></li>
<li class="chapter" data-level="1.3.2" data-path=""><a href="#how-to-make-it-better"><i class="fa fa-check"></i><b>1.3.2</b> How to make it better</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path=""><a href="#data-visualization-using-ggplot2"><i class="fa fa-check"></i><b>1.4</b> Data visualization using <code>ggplot2</code></a><ul>
<li class="chapter" data-level="1.4.1" data-path=""><a href="#setting-up-a-plot"><i class="fa fa-check"></i><b>1.4.1</b> Setting up a plot</a></li>
<li class="chapter" data-level="1.4.2" data-path=""><a href="#setting-the-default-plot-theme"><i class="fa fa-check"></i><b>1.4.2</b> Setting the default plot theme</a></li>
<li class="chapter" data-level="1.4.3" data-path=""><a href="#scatter-plot"><i class="fa fa-check"></i><b>1.4.3</b> Scatter plot</a></li>
<li class="chapter" data-level="1.4.4" data-path=""><a href="#line-plot"><i class="fa fa-check"></i><b>1.4.4</b> Line plot</a></li>
<li class="chapter" data-level="1.4.5" data-path=""><a href="#adding-error-bars"><i class="fa fa-check"></i><b>1.4.5</b> Adding error bars</a></li>
<li class="chapter" data-level="1.4.6" data-path=""><a href="#grouping-data"><i class="fa fa-check"></i><b>1.4.6</b> Grouping data</a></li>
<li class="chapter" data-level="1.4.7" data-path=""><a href="#making-facets"><i class="fa fa-check"></i><b>1.4.7</b> Making facets</a></li>
<li class="chapter" data-level="1.4.8" data-path=""><a href="#more-on-aesthetics"><i class="fa fa-check"></i><b>1.4.8</b> More on aesthetics</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path=""><a href="#additional-resources"><i class="fa fa-check"></i><b>1.5</b> Additional resources</a><ul>
<li class="chapter" data-level="1.5.1" data-path=""><a href="#cheatsheets"><i class="fa fa-check"></i><b>1.5.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="1.5.2" data-path=""><a href="#data-camp-tutorials"><i class="fa fa-check"></i><b>1.5.2</b> Data camp tutorials</a></li>
<li class="chapter" data-level="1.5.3" data-path=""><a href="#books-and-chapters"><i class="fa fa-check"></i><b>1.5.3</b> Books and Chapters</a></li>
<li class="chapter" data-level="1.5.4" data-path=""><a href="#misc"><i class="fa fa-check"></i><b>1.5.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path=""><a href="#session-info"><i class="fa fa-check"></i><b>1.6</b> Session info</a></li>
<li class="chapter" data-level="" data-path=""><a href="#references"><i class="fa fa-check"></i>References</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Class 2</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">Class 2</h1>
<h4 class="author"><em>Tobias Gerstenberg</em></h4>
<h4 class="date"><em>2018-12-21</em></h4>
</div>
<div id="visualization-1" class="section level1">
<h1><span class="header-section-number">1</span> Visualization 1</h1>
<p>In this lecture, we will take a look at how to visualize data using the powerful <a href="https://ggplot2.tidyverse.org/">ggplot2</a> package. We will use ggplot2 a lot throughout the rest of the course!</p>
<div id="learning-objectives" class="section level2">
<h2><span class="header-section-number">1.1</span> Learning objectives</h2>
<ul>
<li>Get familiar with the RStudio interface.</li>
<li>Take a look at some bad plot, and think about how to make them better.</li>
<li>Understand the general philosophy behind ggplot – a grammar of graphics.</li>
<li>Create informative figures using grouping and facets.</li>
<li>Understand the mapping from data to geoms in ggplot.</li>
</ul>
</div>
<div id="load-packages" class="section level2">
<h2><span class="header-section-number">1.2</span> Load packages</h2>
<p>Let’s first load the packages that we need for this chapter.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(<span class="st">&quot;knitr&quot;</span>) <span class="co"># for rendering the RMarkdown file</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>) <span class="co"># for plotting (and many more cool things we&#39;ll discover later)</span></a></code></pre></div>
<p>The “tidyverse” is a collection of packages that includes “ggplot2”.</p>
</div>
<div id="why-visualize-data" class="section level2">
<h2><span class="header-section-number">1.3</span> Why visualize data?</h2>
<blockquote>
<p>“There is no single statistical tool that is as powerful as a well‐chosen graph.” <span class="citation">(Chambers et al. 1983)</span></p>
</blockquote>
<blockquote>
<p>…make <strong>both</strong> calculations <strong>and</strong> graphs. Both sorts of output should be studied; each will contribute to understanding. <span class="citation">(Anscombe 1973)</span></p>
</blockquote>
<div class="figure"><span id="fig:anscombe"></span>
<img src="figures/images/anscombe.png" alt="Anscombe's quartet." width="1316" />
<p class="caption">
Figure 1.1: Anscombe’s quartet.
</p>
</div>
<p>Anscombe’s quartet in Figure <a href="#fig:anscombe">1.1</a> (left side) illustrates the importance of visualizing data. Even though the datasets I-IV have the same summary statistics (mean, standard deviation, correlation), they are importantly different from each other. On the right side, we have four data sets with the same summary statistics that are very similar to each other.</p>
<div class="figure"><span id="fig:correlations"></span>
<img src="figures/images/correlations.png" alt="The Pearson's $r$ correlation coefficient is the same for all of these datasets. Source: [Data Visualization -- A practical introduction by Kieran Healy](http://socviz.co/lookatdata.html#lookatdata)" width="1056" />
<p class="caption">
Figure 1.2: The Pearson’s <span class="math inline">\(r\)</span> correlation coefficient is the same for all of these datasets. Source: <a href="http://socviz.co/lookatdata.html#lookatdata">Data Visualization – A practical introduction by Kieran Healy</a>
</p>
</div>
<p>All the datasets in Figure <a href="#fig:correlations">1.2</a> share the same correlation coefficient. However, again, they are very different from each other.</p>
<div class="figure"><span id="fig:datasaurus"></span>
<img src="figures/images/datasaurus_dozen.png" alt="__The Datasaurus Dozen__. While different in appearance, each dataset has the same summary statistics (mean, standard deviation, and Pearson's correlation) to two decimal places." width="2474" />
<p class="caption">
Figure 1.3: <strong>The Datasaurus Dozen</strong>. While different in appearance, each dataset has the same summary statistics (mean, standard deviation, and Pearson’s correlation) to two decimal places.
</p>
</div>
<p>The data sets in Figure <a href="#fig:datasaurus">1.3</a> all share the same summary statistics. Clearly, the data sets are not the same though.</p>
<div class="info">
<p>
<strong>Tip</strong>:
</p>
<p>
Always plot the data first!
</p>
</div>
<p><a href="https://www.autodeskresearch.com/publications/samestats">Here</a> is the paper from which I took Figure <a href="#fig:anscombe">1.1</a> and <a href="#fig:datasaurus">1.3</a>. It explains how the figures were generated and shows more examples for how summary statistics and some kinds of plots are insufficient to get a good sense for what’s going on in the data.</p>
<div id="how-not-to-visualize-data" class="section level3">
<h3><span class="header-section-number">1.3.1</span> How <em>not</em> to visualize data</h3>
<p>Below are some examples of visualizations that could be improved. How would you make them better?</p>
<div class="figure" style="text-align: center"><span id="fig:bad-plot1"></span>
<img src="figures/images/bad_plot1.png" alt="Example of a bad plot. Source: [Data Visualization -- A practical introduction by Kieran Healy](http://socviz.co/lookatdata.html#lookatdata)" width="90%" />
<p class="caption">
Figure 1.4: Example of a bad plot. Source: <a href="http://socviz.co/lookatdata.html#lookatdata">Data Visualization – A practical introduction by Kieran Healy</a>
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:bad-plot2"></span>
<img src="figures/images/bad_plot2.png" alt="Another bad plot. Source: Google image search for 'bad graphs'" width="90%" />
<p class="caption">
Figure 1.5: Another bad plot. Source: Google image search for ‘bad graphs’
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:bad-plot3"></span>
<img src="figures/images/bad_plot3.png" alt="And another one. Source: [Bad graph wall of shame](http://bcuchta.com/wall_of_shame/)" width="90%" />
<p class="caption">
Figure 1.6: And another one. Source: <a href="http://bcuchta.com/wall_of_shame/">Bad graph wall of shame</a>
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:bad-plot4"></span>
<img src="figures/images/bad_plot4.png" alt="And another one. Source: [Bad graph wall of shame](http://bcuchta.com/wall_of_shame/)" width="90%" />
<p class="caption">
Figure 1.7: And another one. Source: <a href="http://bcuchta.com/wall_of_shame/">Bad graph wall of shame</a>
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:bad-plot5"></span>
<img src="figures/images/bad_plot5.png" alt="And another one. Source: [Bad graph wall of shame](http://bcuchta.com/wall_of_shame/)" width="90%" />
<p class="caption">
Figure 1.8: And another one. Source: <a href="http://bcuchta.com/wall_of_shame/">Bad graph wall of shame</a>
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:bad-plot6"></span>
<img src="figures/images/bad_plot6.png" alt="The last one for now. Source: [Bad graph wall of shame](http://bcuchta.com/wall_of_shame/)" width="90%" />
<p class="caption">
Figure 1.9: The last one for now. Source: <a href="http://bcuchta.com/wall_of_shame/">Bad graph wall of shame</a>
</p>
</div>
</div>
<div id="how-to-make-it-better" class="section level3">
<h3><span class="header-section-number">1.3.2</span> How to make it better</h3>
<p>In this class, we you will learn how to use ggplot2 to make nice figures. The <code>ggplot2</code> library provides a unified framework for making plots – it defines a grammar of graphics according to which we construct figures step by step.</p>
<p>Instead of learning rigid rules for what makes for a good figure, you will learn how to make figures yourself, play around with things, and get a feeling for what works best.</p>
</div>
</div>
<div id="data-visualization-using-ggplot2" class="section level2">
<h2><span class="header-section-number">1.4</span> Data visualization using <code>ggplot2</code></h2>
<p>We will use the <code>ggplot2</code> package to visualize data. By the end of this chapter, you’ll be able to make a figure like this:</p>
<div class="figure"><span id="fig:nice-plot"></span>
<img src="figures/images/combined_plot.pdf" alt="What a nice figure!"  />
<p class="caption">
Figure 1.10: What a nice figure!
</p>
</div>
<p>Now let’s figure out how to get there.</p>
<div id="setting-up-a-plot" class="section level3">
<h3><span class="header-section-number">1.4.1</span> Setting up a plot</h3>
<p>Let’s first get some data.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">df.diamonds =<span class="st"> </span>diamonds </a></code></pre></div>
<p>The <code>diamonds</code> dataset comes with the ggplot2 package. We can get a description of the dataset by running the following command:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">?diamonds</a></code></pre></div>
<div class="info">
<p>
<strong>Tip</strong>:
</p>
<p>
To see the help file, hover over a function (or dataset) with the mouse (or select the text) and then press <code>F1</code>.
</p>
</div>
<p>Above, we assigned the <code>diamonds</code> dataset to the variable <code>df.diamonds</code> so that we can see it in the data explorer.</p>
<p>Let’s take a look at the full dataset by clicking on it in the explorer.</p>
<div class="info">
<p>
<strong>Tip</strong>:
</p>
<p>
You can view a data frame by highlighting the text in the editor (or simply moving the mouse above the text), and then press <code>F2</code>.
</p>
</div>
<p>The <code>df.diamonds</code> data frame contains information about almost 60,000 diamonds, including their <code>price</code>, <code>carat</code> value, size, etc. Let’s use visualization to get a better sense for this dataset.</p>
<p>We start by setting up the plot. To do so, we pass a data frame to the function <code>ggplot()</code> in the following way.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.diamonds)</a></code></pre></div>
<p><img src="visualization1_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>This, by itself, won’t do anything yet. We also need to specify what to plot.</p>
<p>Let’s take a look at how much diamonds of different color cost. The help file says that diamonds labeled D have the best color, and diamonds labeled J the worst color. Let’s make a bar plot that shows the average price of diamonds for different colors.</p>
<p>We do so via specifying a mapping from the data to the plot aesthetics with the function <code>mapping = aes()</code>. We need to tell <code>aes()</code> what we would like to display on the x-axis, and the y-axis of the plot.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.diamonds, </a>
<a class="sourceLine" id="cb5-2" title="2">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> color, <span class="dt">y =</span> price))</a></code></pre></div>
<p><img src="visualization1_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Here, we specified that we want to plot color on the x-axis, and the average price on the y-axis. As you can see, <code>ggplot2</code> has already figured out how to label the axes. However, we still need to specify <em>how</em> to plot it. Let’s make a <strong>bar graph</strong>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.diamonds, </a>
<a class="sourceLine" id="cb6-2" title="2">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> color, <span class="dt">y =</span> price))<span class="op">+</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">geom =</span> <span class="st">&quot;bar&quot;</span>)</a></code></pre></div>
<p><img src="visualization1_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Neat! Two lines of code produce an almost-publication-ready plot (to be published in the <em>Proceedings of Unnecessary Diamonds</em>)! Note how we used a <code>+</code> at the end of the first line of code to specify that there will be more. This is a very powerful idea underlying <code>ggplot2</code>. We can start simple and keep adding things to the plot step by step.</p>
<p>We used the <code>stat_summary()</code> function to define <em>what</em> we want to plot (the “mean”), and <em>how</em> (as a “bar” chart). Let’s take a closer look at that function.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">help</span>(stat_summary)</a></code></pre></div>
<p>Not the the easiest help file … We supplied two arguments to the function, <code>fun.y =</code> and <code>geom =</code>.</p>
<ol style="list-style-type: decimal">
<li>The <code>fun.y</code> argument specifies <em>what</em> function we’d like to apply to the data for each value of x. Here, we said that we would like to take the <code>mean</code> and we specified that as a string.</li>
<li>The <code>geom</code> (= geometric object) argument specifies <em>how</em> we would like to plot the result, namely as a “bar” plot.</li>
</ol>
<p>Instead of showing the “mean”, we could also show the “median” instead.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.diamonds, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> color, <span class="dt">y =</span> price))<span class="op">+</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> <span class="st">&quot;median&quot;</span>, <span class="dt">geom =</span> <span class="st">&quot;bar&quot;</span>)</a></code></pre></div>
<p><img src="visualization1_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>And instead of making a bar plot, we could plot some points.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">ggplot</span>(df.diamonds, <span class="kw">aes</span>(<span class="dt">x =</span> color, <span class="dt">y =</span> price))<span class="op">+</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>)</a></code></pre></div>
<p><img src="visualization1_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="info">
<p>
<strong>Tip</strong>:
</p>
<p>
Take a look <a href="https://ggplot2.tidyverse.org/reference/#section-layer-geoms">here</a> to see what other geoms ggplot2 supports.
</p>
</div>
<p>Somewhat surprisingly, diamonds with the best color (D) are not the most expensive ones. What’s going on here? We’ll need to do some more exploration to figure this out.</p>
<p>Note that in the last plot, I removed the <code>data =</code> and <code>mapping =</code> specifiers. These keywords are optional, and as long as we provide the arguments to the function in the correct order, we are ok. So, the following doesn’t work:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> color, <span class="dt">y =</span> price), df.diamonds)<span class="op">+</span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>)</a></code></pre></div>
<p>While this works:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> color, <span class="dt">y =</span> price), <span class="dt">data =</span> df.diamonds)<span class="op">+</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>)</a></code></pre></div>
<p><img src="visualization1_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>In general, it’s good practice to include the specifiers – particularly for functions that are not used all the time. If the same function is used multiple times throughout the script, I would suggest to use the specifiers first, and then it’s ok to drop them later.</p>
</div>
<div id="setting-the-default-plot-theme" class="section level3">
<h3><span class="header-section-number">1.4.2</span> Setting the default plot theme</h3>
<p>Before moving one, let’s set a different default theme for our plots. Personally, I’m not a big fan of the gray background and the white grid lines. Also, the default size of the text should be bigger. We can change the default theme using the <code>theme_set()</code> function like so:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">theme_set</span>(</a>
<a class="sourceLine" id="cb12-2" title="2">  <span class="kw">theme_classic</span>()<span class="op">+</span><span class="st"> </span><span class="co">#set the theme </span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>)) <span class="co">#set the default text size</span></a>
<a class="sourceLine" id="cb12-4" title="4">)</a></code></pre></div>
<p>From now onwards, all our plots will use what specified in <code>theme_classic()</code>, and the default text size will be larger, too.</p>
</div>
<div id="scatter-plot" class="section level3">
<h3><span class="header-section-number">1.4.3</span> Scatter plot</h3>
<p>I don’t know much about diamonds, but I do know that diamonds with a higher <code>carat</code> value are better. <code>color</code> was a discrete variable with seven different values. <code>carat</code>, however, is a continuous variable. We want to see how the price of diamonds differs as a function of the <code>carat</code> value. Since we are interested in the relationship between two continuous variables, plotting a bar graph won’t work. Instead, let’s make a <strong>scatter plot</strong>. Let’s put the <code>carat</code> value on the x-axis, and the <code>price</code> on the y-axis.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.diamonds, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> carat, <span class="dt">y =</span> price))<span class="op">+</span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>()</a></code></pre></div>
<div class="figure"><span id="fig:scatterplot"></span>
<img src="visualization1_files/figure-html/scatterplot-1.png" alt="Scatterplot." width="672" />
<p class="caption">
Figure 1.11: Scatterplot.
</p>
</div>
<p>Cool! That looks sensible. Diamonds with a higher <code>carat</code> value tend to have a higher <code>price</code>. Our dataset has 53940 rows. So the plot actually shows 53940 circles even though we can’t see all of them since they overlap.</p>
<p>Let’s make some progress on trying to figure out why the diamonds with the better color weren’t the most expensive ones on average. We’ll add some color to the scatter plot in Figure <a href="#fig:scatterplot">1.11</a>. We color each of the points based on the diamond’s color. To do so, we pass another argument to the aesthetics of the plot via <code>aes()</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.diamonds, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> carat, <span class="dt">y =</span> price, <span class="dt">color =</span> color))<span class="op">+</span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>()</a></code></pre></div>
<div class="figure"><span id="fig:scatterplot-color"></span>
<img src="visualization1_files/figure-html/scatterplot-color-1.png" alt="Scatterplot with color." width="672" />
<p class="caption">
Figure 1.12: Scatterplot with color.
</p>
</div>
<p>Aha! Now we’ve got some color. Notice how in Figure <a href="#fig:scatterplot-color">1.12</a> <code>ggplot2</code> added a legend for us, thanks! We’ll see later how to play around with legends. Form just eye-balling the plot, it looks like the diamonds with the best <code>color</code> (D) tended to have a lower <code>carat</code> value, and the ones with the worst <code>color</code> (J), tended to have the highest carat values.</p>
<p>There are many other things that we can define in <code>aes()</code>. Take a quick look at the vignette:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">vignette</span>(<span class="st">&quot;ggplot2-specs&quot;</span>)</a></code></pre></div>
</div>
<div id="line-plot" class="section level3">
<h3><span class="header-section-number">1.4.4</span> Line plot</h3>
<p>What else do we know about the diamonds? We actually know the quality of how they were cut. The <code>cut</code> variable ranges from “Fair” to “Ideal”. First, let’s take a look at the relationship between <code>cut</code> and <code>price</code>. This time, we’ll make a line plot instead of a bar plot (just because we can).</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.diamonds, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">y =</span> price))<span class="op">+</span></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>)</a>
<a class="sourceLine" id="cb16-3" title="3"><span class="co">#&gt; geom_path: Each group consists of only one observation. Do you need to</span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="co">#&gt; adjust the group aesthetic?</span></a></code></pre></div>
<p><img src="visualization1_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Oops! All we did is that we replaced <code>x = color</code> with <code>x = cut</code>, and <code>geom = "bar"</code> with <code>geom = "line"</code>. However, the plot doesn’t look like expected (i.e. there is no real plot). What happened here? The reason is that the line plot needs to know what points to connect. The error message tells us that each group consists of only one observation. Let’s adjust the group asthetic to fix this.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.diamonds, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">y =</span> price, <span class="dt">group =</span> <span class="dv">1</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>)</a></code></pre></div>
<p><img src="visualization1_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>By adding the parameter <code>group = 1</code> to <code>mapping = aes()</code>, we specify that we would like all the levels in <code>x = cut</code> to be treated as coming from the same group. The reason for this is that <code>cut</code> (our x-axis variable) is a factor (and not a numeric variable), so, by default, <code>ggplot2</code> tries to draw a separate line for each factor level. We’ll learn more about grouping below (and about factors later).</p>
<p>Interestingly, there is no simple relationship between the quality of the cut and the price of the diamond. In fact, “Ideal” diamonds tend to be cheapest.</p>
</div>
<div id="adding-error-bars" class="section level3">
<h3><span class="header-section-number">1.4.5</span> Adding error bars</h3>
<p>We often don’t just want to show the means but also give a sense for how much the data varies. <code>ggplot2</code> has some convenient ways of specifying error bars. Let’s take a look at how much <code>price</code> varies as a function of <code>clarity</code> (another variable in our <code>diamonds</code> data frame).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.diamonds, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> clarity, <span class="dt">y =</span> price))<span class="op">+</span></a>
<a class="sourceLine" id="cb18-2" title="2"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>, <span class="dt">geom =</span> <span class="st">&quot;linerange&quot;</span>)<span class="op">+</span><span class="st"> </span><span class="co"># plot bootstrapped error bars first</span></a>
<a class="sourceLine" id="cb18-3" title="3"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>) <span class="co">#add points with means</span></a></code></pre></div>
<div class="figure"><span id="fig:errorbars"></span>
<img src="visualization1_files/figure-html/errorbars-1.png" alt="Relationship between diamond clarity and price. Error bars indicate 95% bootstrapped confidence intervals." width="672" />
<p class="caption">
Figure 1.13: Relationship between diamond clarity and price. Error bars indicate 95% bootstrapped confidence intervals.
</p>
</div>
<p>Here we have it. The average price of our diamonds for different levels of <code>clarity</code> together with bootstrapped 95% confidence intervals. How do we know that we have 95% confidence intervals? That’s what <code>mean_cl_boot()</code> computes as a default. Let’s take a look at that function:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">help</span>(mean_cl_boot)</a></code></pre></div>
<p>Remember that you can just select the text (or merely put the cursor over the word) and press <code>F1</code> to see the help. The help file tell us about the function <code>smean.cl.boot</code> in the <code>Hmisc</code> package. The <code>mean_cl_boot()</code> function is a version that works well with <code>ggplot2</code>. We see that this function takes as inputs, the confidence interval <code>conf.int</code>, the number of bootstrap samples <code>B</code>, and some other ones that we don’t care about for now. So let’s make the same plot again with 99.9% confidence intervals, and 2000 bootstrap samples.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.diamonds, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> clarity, <span class="dt">y =</span> price))<span class="op">+</span></a>
<a class="sourceLine" id="cb20-2" title="2"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>, <span class="dt">geom =</span> <span class="st">&quot;linerange&quot;</span>, <span class="dt">fun.args =</span> <span class="kw">list</span>(<span class="dt">conf.int =</span> <span class="fl">.999</span>, <span class="dt">B =</span> <span class="dv">2000</span>))<span class="op">+</span><span class="st"> </span><span class="co"># plot bootstrapped error bars first</span></a>
<a class="sourceLine" id="cb20-3" title="3"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>) <span class="co">#add points with means</span></a></code></pre></div>
<p><img src="visualization1_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Note how the error bars are larger now compared to Figure <a href="#fig:errorbars">1.13</a>
. Note the somewhat peculiar way in which we supplied the parameters to the <code>mean_cl_boot</code> function. The <code>fun.args</code> argument takes in a list of arguments that it then passes on to the function <code>mean_cl_boot</code>.</p>
<p>One cool feature about using <code>stat_summary()</code> is that we did not have to change anything about the data frame that we used to make the plots. We directly used our raw data instead of having to make separate data frames that contain the relevant information (such as the means and the confidence intervals).</p>
<p>You may not remember exactly what confidence intervals actually are. Don’t worry! We’ll have a recap later in class.</p>
<p>Let’s take a look at two more principles for plotting data that are extremely helpful: groups and facets.</p>
</div>
<div id="grouping-data" class="section level3">
<h3><span class="header-section-number">1.4.6</span> Grouping data</h3>
<p>Grouping in <code>ggplot2</code> is a very powerful idea. It allows us to plot subsets of the data without the need to make separate data frames first.</p>
<p>Let’s make a plot that shows the relationship between <code>price</code> and <code>color</code> separately for the different qualities of <code>cut</code>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.diamonds, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> color, <span class="dt">y =</span> price, <span class="dt">group =</span> cut))<span class="op">+</span></a>
<a class="sourceLine" id="cb21-2" title="2"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>)</a></code></pre></div>
<p><img src="visualization1_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>Well, we got some separate lines here but we don’t know which line corresponds to which cut. Let’s add some color!</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.diamonds, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> color, <span class="dt">y =</span> price, <span class="dt">group =</span> cut, <span class="dt">color =</span> cut))<span class="op">+</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="visualization1_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>Nice! In addition to adding color, I’ve made the lines a little thicker here by setting the <code>size</code> argument to 2.</p>
<p>Grouping is very useful for bar plots. Let’s take a look at how the average price of diamonds looks like taking into account both <code>cut</code> and <code>color</code> (I know – exciting times!). Let’s put the <code>color</code> on the x-axis and then group by the <code>cut</code>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.diamonds, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> color, <span class="dt">y =</span> price, <span class="dt">group =</span> cut, <span class="dt">color =</span> cut))<span class="op">+</span></a>
<a class="sourceLine" id="cb23-2" title="2"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">geom =</span> <span class="st">&quot;bar&quot;</span>)</a></code></pre></div>
<p><img src="visualization1_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>That’s a fail! Several things went wrong here. First, all the bars are gray and only their outline is colored differently. Instead we want the bars to have a different color. For that we need to specify the <code>fill</code> argument rather than the <code>color</code> argument. But things are worse. The bars currently are shown on top of each other. Instead, we’d like to put them next to each other. Here is how to do that:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.diamonds, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> color, <span class="dt">y =</span> price, <span class="dt">group =</span> cut, <span class="dt">fill =</span> cut))<span class="op">+</span></a>
<a class="sourceLine" id="cb24-2" title="2"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">geom =</span> <span class="st">&quot;bar&quot;</span>, <span class="dt">position =</span> <span class="kw">position_dodge</span>())</a></code></pre></div>
<p><img src="visualization1_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>Neato! We’ve changed the <code>color</code> argument to <code>fill</code>, and have added the <code>position = position_dodge()</code> argument to the <code>stat_summary()</code> call. This argument makes it such that the bars are nicely dodged next to each other. Let’s add some error bars just for kicks.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.diamonds, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> color, <span class="dt">y =</span> price, <span class="dt">group =</span> cut, <span class="dt">fill =</span> cut))<span class="op">+</span></a>
<a class="sourceLine" id="cb25-2" title="2"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">geom =</span> <span class="st">&quot;bar&quot;</span>, <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="fl">0.9</span>), <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb25-3" title="3"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>, <span class="dt">geom =</span> <span class="st">&quot;linerange&quot;</span>, <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="fl">0.9</span>))</a></code></pre></div>
<p><img src="visualization1_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>Voila! Now with error bars. Note that we’ve added the <code>width = 0.9</code> argument to <code>position_dodge()</code>. Somehow R was complaining when this was not defined for geom “linerange”. I’ve also added some outline to the bars by including the argument <code>color = "black"</code>. I think it looks nicer this way.</p>
<p>So, still somewhat surprisingly, diamonds with the worst color (J) are more expensive than dimanods with the best color (D), and diamonds with better cuts are not necessarily more expensive.</p>
</div>
<div id="making-facets" class="section level3">
<h3><span class="header-section-number">1.4.7</span> Making facets</h3>
<p>Having too much information in a single plot can be overwhelming. The previous plot is already pretty busy. Facets are a nice way of spliting up plots and showing information in separate panels.</p>
<p>Let’s take a look at how wide these diamonds tend to be. The width in mm is given in the <code>y</code> column of the diamonds data frame. We’ll make a histogram first. To make a histogram, the only aesthetic we needed to specify is <code>x</code>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.diamonds, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> y))<span class="op">+</span></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="st">  </span><span class="kw">geom_histogram</span>()</a>
<a class="sourceLine" id="cb26-3" title="3"><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></a></code></pre></div>
<p><img src="visualization1_files/figure-html/histogram1-1.png" width="672" /></p>
<p>That looks bad! Let’s pick a different value for the width of the bins in the histogram.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.diamonds, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> y))<span class="op">+</span></a>
<a class="sourceLine" id="cb27-2" title="2"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.1</span>)</a></code></pre></div>
<p><img src="visualization1_files/figure-html/histogram2-1.png" width="672" /></p>
<p>Still bad. There seems to be an outlier diamond that happens to be almost 60 mm wide, while most of the rest is much narrower. One option would be to remove the outlier from the data before plotting it. But generally, we don’t want to make new data frames. Instead, let’s just limit what data we want to show in the plot.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.diamonds, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> y))<span class="op">+</span></a>
<a class="sourceLine" id="cb28-2" title="2"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.1</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb28-3" title="3"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">10</span>))</a></code></pre></div>
<p><img src="visualization1_files/figure-html/histogram3-1.png" width="672" /></p>
<p>I’ve used the <code>coord_cartesian()</code> function to restrict the range of data to show by passing a minimum and maximum to the <code>xlim</code> argument. This looks better now.</p>
<p>Instead of histograms, we can also plot a density fitted to the distribution.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.diamonds, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> y))<span class="op">+</span></a>
<a class="sourceLine" id="cb29-2" title="2"><span class="st">  </span><span class="kw">geom_density</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb29-3" title="3"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">10</span>))</a></code></pre></div>
<p><img src="visualization1_files/figure-html/density1-1.png" width="672" /></p>
<p>Looks pretty similar to our histogram above! Just like we can play around with the binwidth of the histogram, we can change the smoothing bandwidth of the kernel that is used to create the histogram. Here is a histogram with a much wider bandwidth:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.diamonds, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> y))<span class="op">+</span></a>
<a class="sourceLine" id="cb30-2" title="2"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">bw =</span> <span class="fl">0.5</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb30-3" title="3"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">10</span>))</a></code></pre></div>
<p><img src="visualization1_files/figure-html/density2-1.png" width="672" /></p>
<p>We’ll learn more about how these densities are determined later in class.</p>
<p>I promised that this section was about making facets, right? We’re getting there! Let’s first take a look at how wide diamonds of different color are. We can use grouping to make this happen.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.diamonds, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> y, <span class="dt">group =</span> color, <span class="dt">fill =</span> color))<span class="op">+</span></a>
<a class="sourceLine" id="cb31-2" title="2"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">bw =</span> <span class="fl">0.2</span>, <span class="dt">alpha =</span> <span class="fl">0.2</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb31-3" title="3"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">10</span>))</a></code></pre></div>
<p><img src="visualization1_files/figure-html/density3-1.png" width="672" /></p>
<p>OK! That’s a little tricky to tell apart. Notice that I’ve specified the <code>alpha</code> argument in the <code>geom_density()</code> function so that the densities in the front don’t completely hide the densities in the back. But this plot still looks too busy. Instead of grouping, let’s put the densities for the different colors, in separate panels. That’s what facetting allows you to do.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.diamonds, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> y, <span class="dt">fill =</span> color))<span class="op">+</span></a>
<a class="sourceLine" id="cb32-2" title="2"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">bw =</span> <span class="fl">0.2</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb32-3" title="3"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="dt">cols =</span> <span class="kw">vars</span>(color))<span class="op">+</span></a>
<a class="sourceLine" id="cb32-4" title="4"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">10</span>))</a></code></pre></div>
<p><img src="visualization1_files/figure-html/density4-1.png" width="672" /></p>
<p>Now we have the densities next to each other in separate panels. I’ve removed the <code>alpha</code> argument since the densities aren’t overlapping anymore. To make the different panels, I used the <code>facet_grid()</code> function and specified that I want separate columns for the different colors (<code>cols = vars(color)</code>). What’s the deal with <code>vars()</code>? Why couldn’t we just write <code>facet_grid(cols = color)</code> instead? The short answer is: that’s what the function wants. The long answer is: long. (We’ll learn more about this later in the course.)</p>
<p>To show the facets in different rows instead of columns we simply replace <code>cols = vars(color)</code> with <code>rows = vars(color)</code>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.diamonds, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> y, <span class="dt">fill =</span> color))<span class="op">+</span></a>
<a class="sourceLine" id="cb33-2" title="2"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">bw =</span> <span class="fl">0.2</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb33-3" title="3"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="dt">rows =</span> <span class="kw">vars</span>(color))<span class="op">+</span></a>
<a class="sourceLine" id="cb33-4" title="4"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">10</span>))</a></code></pre></div>
<p><img src="visualization1_files/figure-html/density5-1.png" width="672" /></p>
<p>Several aspects about this plot should be improved:</p>
<ul>
<li>the y-axis text is overlapping</li>
<li>having both a legend and separate facet labels is redundant</li>
<li>having separate fills is not really necessary here</li>
</ul>
<p>So, what does this plot actually show us? Well, J-colored diamonds tend to be wider than D-colored diamonds. Fascinating!</p>
<p>Of course, we could go completely overboard with facets and groups. So let’s do it! Let’s look at how the average <code>price</code> (somewhat more interesting) varies as a function of <code>color</code>, <code>cut</code>, and <code>clarity</code>. We’ll put color on the x-axis, and make separate rows for <code>cut</code> and columns for <code>clarity</code>.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.diamonds, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">y =</span> price, <span class="dt">x =</span> color, <span class="dt">fill =</span> color))<span class="op">+</span></a>
<a class="sourceLine" id="cb34-2" title="2"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">geom =</span> <span class="st">&quot;bar&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb34-3" title="3"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>, <span class="dt">geom =</span> <span class="st">&quot;linerange&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb34-4" title="4"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="dt">rows =</span> <span class="kw">vars</span>(cut), <span class="dt">cols =</span> <span class="kw">vars</span>(clarity))</a>
<a class="sourceLine" id="cb34-5" title="5"><span class="co">#&gt; Warning: Removed 5 rows containing missing values (geom_linerange).</span></a></code></pre></div>
<div class="figure"><span id="fig:stretching-it"></span>
<img src="visualization1_files/figure-html/stretching-it-1.png" alt="A figure that is stretching it in terms of information." width="672" />
<p class="caption">
Figure 1.14: A figure that is stretching it in terms of information.
</p>
</div>
<p>Figure <a href="#fig:stretching-it">1.14</a> is stretching it in terms of how much information it presents. But it gives you a sense for how to combine the differnet bits and pieces we’ve learned so far.</p>
</div>
<div id="more-on-aesthetics" class="section level3">
<h3><span class="header-section-number">1.4.8</span> More on aesthetics</h3>
<ul>
<li>explain distinction between global mapping, local mapping, and setting</li>
</ul>
<p><code>ggplot2</code> allows you to specify the plot aesthetics in different ways.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.diamonds, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> carat, <span class="dt">y =</span> price, <span class="dt">color =</span> color))<span class="op">+</span></a>
<a class="sourceLine" id="cb35-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb35-3" title="3"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> F)</a></code></pre></div>
<p><img src="visualization1_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>Here, I’ve drawn a scatter plot of the relationship between <code>carat</code> and <code>price</code>, and I have added the best-fitting regression lines via the <code>geom_smooth(method = "lm")</code> call. (We will learn much more about what these regression lines mean later in class.)</p>
<p>Because I have defined all the aesthetics at the top level (i.e. directly within the <code>ggplot()</code> function), the aesthetics apply to all the functions afterwards. In this case, the <code>geom_point()</code> and the <code>geom_smooth()</code> functions. The <code>geom_smooth()</code> function produces separate best-fit regression lines for each different color.</p>
<p>But what if we only wanted to show one regression line instead that applies to all the data? Here is one way of doing so:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.diamonds, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> carat, <span class="dt">y =</span> price))<span class="op">+</span></a>
<a class="sourceLine" id="cb36-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">color =</span> color))<span class="op">+</span></a>
<a class="sourceLine" id="cb36-3" title="3"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)</a></code></pre></div>
<p><img src="visualization1_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<p>Here, I’ve moved the color aesthetic into the <code>geom_point()</code> function call. Now, the <code>x</code> and <code>y</code> aesthetics still apply to both the <code>geom_point()</code> and the <code>geom_smooth()</code> function call, but the <code>color</code> aesthetic applies only to <code>geom_point()</code>. Alternatively, we can simply overwrite global aesthetics within local function calls.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.diamonds, <span class="kw">aes</span>(<span class="dt">x =</span> carat, <span class="dt">y =</span> price, <span class="dt">color =</span> color))<span class="op">+</span></a>
<a class="sourceLine" id="cb37-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb37-3" title="3"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">color =</span> <span class="st">&#39;black&#39;</span>)</a></code></pre></div>
<p><img src="visualization1_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p>Here, I’ve set <code>color = 'black'</code> within the <code>geom_smooth()</code> function, and now only one global regression line is displayed since the global color aesthetic was overwritten in the local function call.</p>
</div>
</div>
<div id="additional-resources" class="section level2">
<h2><span class="header-section-number">1.5</span> Additional resources</h2>
<div id="cheatsheets" class="section level3">
<h3><span class="header-section-number">1.5.1</span> Cheatsheets</h3>
<ul>
<li><a href="figures/cheatsheets/visualization-principles.pdf">Data visualization</a> –&gt; general principles of effective graphic design</li>
<li><a href="figures/cheatsheets/data-visualization.pdf">ggplot2</a> –&gt; specific information about ggplot</li>
</ul>
</div>
<div id="data-camp-tutorials" class="section level3">
<h3><span class="header-section-number">1.5.2</span> Data camp tutorials</h3>
<ul>
<li><a href="https://www.datacamp.com/courses/data-visualization-with-ggplot2-1">ggplot2 course 1</a></li>
<li><a href="https://www.datacamp.com/courses/data-visualization-with-ggplot2-2">ggplot2 course 2</a></li>
</ul>
</div>
<div id="books-and-chapters" class="section level3">
<h3><span class="header-section-number">1.5.3</span> Books and Chapters</h3>
<ul>
<li><a href="http://www.cookbook-r.com/Graphs/">R graphics cookbook</a> –&gt; quick intro to the the most common graphs</li>
<li><a href="http://r4ds.had.co.nz/">R for Data Science book</a>
<ul>
<li><a href="http://r4ds.had.co.nz/data-visualisation.html">Data visualization</a></li>
<li><a href="http://r4ds.had.co.nz/graphics-for-communication.html">Graphics for communication</a></li>
</ul></li>
<li><a href="http://socviz.co/">Data Visualization – A practical introduction (by Kieran Healy)</a>
<ul>
<li><a href="http://socviz.co/lookatdata.html#lookatdata">Look at data</a></li>
<li><a href="http://socviz.co/makeplot.html#makeplot">Make a plot</a></li>
<li><a href="http://socviz.co/groupfacettx.html#groupfacettx">Show the right numbers</a></li>
<li><a href="http://socviz.co/refineplots.html#refineplots">Refine your plots</a></li>
</ul></li>
<li><a href="https://serialmentor.com/dataviz/">Fundamentals of Data Visualization</a> –&gt; very nice resource that goes beyond basic functionality of <code>ggplot</code> and focuses on how to make good figures (e.g. how to choose colors, axes, …)</li>
</ul>
</div>
<div id="misc" class="section level3">
<h3><span class="header-section-number">1.5.4</span> Misc</h3>
<ul>
<li><a href="http://www.ggplot2-exts.org/gallery/">ggplot2 extensions</a> –&gt; gallery of ggplot2 extension packages</li>
<li><a href="https://github.com/dreamRs/esquisse">ggplot2 gui</a> –&gt; ggplot2 extension package</li>
<li><a href="http://r-statistics.co/Top50-Ggplot2-Visualizations-MasterList-R-Code.html">ggplot2 visualizations with code</a> –&gt; gallery of plots with code</li>
</ul>
</div>
</div>
<div id="session-info" class="section level2">
<h2><span class="header-section-number">1.6</span> Session info</h2>
<p>Information about this R session including which version of R was used, and what packages were loaded.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="kw">sessionInfo</span>()</a>
<a class="sourceLine" id="cb38-2" title="2"><span class="co">#&gt; R version 3.5.1 (2018-07-02)</span></a>
<a class="sourceLine" id="cb38-3" title="3"><span class="co">#&gt; Platform: x86_64-apple-darwin15.6.0 (64-bit)</span></a>
<a class="sourceLine" id="cb38-4" title="4"><span class="co">#&gt; Running under: macOS  10.14.2</span></a>
<a class="sourceLine" id="cb38-5" title="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb38-6" title="6"><span class="co">#&gt; Matrix products: default</span></a>
<a class="sourceLine" id="cb38-7" title="7"><span class="co">#&gt; BLAS: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRblas.0.dylib</span></a>
<a class="sourceLine" id="cb38-8" title="8"><span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRlapack.dylib</span></a>
<a class="sourceLine" id="cb38-9" title="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb38-10" title="10"><span class="co">#&gt; locale:</span></a>
<a class="sourceLine" id="cb38-11" title="11"><span class="co">#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></a>
<a class="sourceLine" id="cb38-12" title="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb38-13" title="13"><span class="co">#&gt; attached base packages:</span></a>
<a class="sourceLine" id="cb38-14" title="14"><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></a>
<a class="sourceLine" id="cb38-15" title="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb38-16" title="16"><span class="co">#&gt; other attached packages:</span></a>
<a class="sourceLine" id="cb38-17" title="17"><span class="co">#&gt;  [1] forcats_0.3.0   stringr_1.3.1   dplyr_0.7.8     purrr_0.2.5    </span></a>
<a class="sourceLine" id="cb38-18" title="18"><span class="co">#&gt;  [5] readr_1.3.0     tidyr_0.8.2     tibble_1.4.2    ggplot2_3.1.0  </span></a>
<a class="sourceLine" id="cb38-19" title="19"><span class="co">#&gt;  [9] tidyverse_1.2.1 knitr_1.20     </span></a>
<a class="sourceLine" id="cb38-20" title="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb38-21" title="21"><span class="co">#&gt; loaded via a namespace (and not attached):</span></a>
<a class="sourceLine" id="cb38-22" title="22"><span class="co">#&gt;  [1] Rcpp_1.0.0            lubridate_1.7.4       lattice_0.20-38      </span></a>
<a class="sourceLine" id="cb38-23" title="23"><span class="co">#&gt;  [4] png_0.1-7             assertthat_0.2.0      rprojroot_1.3-2      </span></a>
<a class="sourceLine" id="cb38-24" title="24"><span class="co">#&gt;  [7] digest_0.6.18         R6_2.3.0              cellranger_1.1.0     </span></a>
<a class="sourceLine" id="cb38-25" title="25"><span class="co">#&gt; [10] plyr_1.8.4            backports_1.1.2       acepack_1.4.1        </span></a>
<a class="sourceLine" id="cb38-26" title="26"><span class="co">#&gt; [13] evaluate_0.12         httr_1.3.1            highr_0.7            </span></a>
<a class="sourceLine" id="cb38-27" title="27"><span class="co">#&gt; [16] pillar_1.3.1          rlang_0.3.0.1         lazyeval_0.2.1       </span></a>
<a class="sourceLine" id="cb38-28" title="28"><span class="co">#&gt; [19] readxl_1.1.0          data.table_1.11.8     rstudioapi_0.8.0.9000</span></a>
<a class="sourceLine" id="cb38-29" title="29"><span class="co">#&gt; [22] rpart_4.1-13          Matrix_1.2-15         checkmate_1.8.5      </span></a>
<a class="sourceLine" id="cb38-30" title="30"><span class="co">#&gt; [25] rmarkdown_1.10        labeling_0.3          splines_3.5.1        </span></a>
<a class="sourceLine" id="cb38-31" title="31"><span class="co">#&gt; [28] foreign_0.8-71        htmlwidgets_1.3       munsell_0.5.0        </span></a>
<a class="sourceLine" id="cb38-32" title="32"><span class="co">#&gt; [31] broom_0.5.0           compiler_3.5.1        modelr_0.1.2         </span></a>
<a class="sourceLine" id="cb38-33" title="33"><span class="co">#&gt; [34] xfun_0.4              pkgconfig_2.0.2       base64enc_0.1-3      </span></a>
<a class="sourceLine" id="cb38-34" title="34"><span class="co">#&gt; [37] htmltools_0.3.6       nnet_7.3-12           tidyselect_0.2.5     </span></a>
<a class="sourceLine" id="cb38-35" title="35"><span class="co">#&gt; [40] htmlTable_1.12        gridExtra_2.3         bookdown_0.7         </span></a>
<a class="sourceLine" id="cb38-36" title="36"><span class="co">#&gt; [43] Hmisc_4.1-1           viridisLite_0.3.0     crayon_1.3.4         </span></a>
<a class="sourceLine" id="cb38-37" title="37"><span class="co">#&gt; [46] withr_2.1.2           grid_3.5.1            nlme_3.1-137         </span></a>
<a class="sourceLine" id="cb38-38" title="38"><span class="co">#&gt; [49] jsonlite_1.6          gtable_0.2.0          magrittr_1.5         </span></a>
<a class="sourceLine" id="cb38-39" title="39"><span class="co">#&gt; [52] scales_1.0.0          cli_1.0.1             stringi_1.2.4        </span></a>
<a class="sourceLine" id="cb38-40" title="40"><span class="co">#&gt; [55] reshape2_1.4.3        bindrcpp_0.2.2        latticeExtra_0.6-28  </span></a>
<a class="sourceLine" id="cb38-41" title="41"><span class="co">#&gt; [58] xml2_1.2.0            Formula_1.2-3         RColorBrewer_1.1-2   </span></a>
<a class="sourceLine" id="cb38-42" title="42"><span class="co">#&gt; [61] tools_3.5.1           glue_1.3.0            hms_0.4.2            </span></a>
<a class="sourceLine" id="cb38-43" title="43"><span class="co">#&gt; [64] survival_2.43-3       yaml_2.2.0            colorspace_1.3-2     </span></a>
<a class="sourceLine" id="cb38-44" title="44"><span class="co">#&gt; [67] cluster_2.0.7-1       rvest_0.3.2           bindr_0.1.1          </span></a>
<a class="sourceLine" id="cb38-45" title="45"><span class="co">#&gt; [70] haven_2.0.0</span></a></code></pre></div>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div>
<p>Anscombe, FJ. 1973. “The American Statistician 27.” <em>Graphs in Statistical Analysis</em>, no. 1: 17–21.</p>
</div>
<div>
<p>Chambers, John M, William S Cleveland, Beat Kleiner, and Paul A Tukey. 1983. “Graphical Methods for Data Analysis.” <em>Wadsworth, Belmont, CA</em>.</p>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>


    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
